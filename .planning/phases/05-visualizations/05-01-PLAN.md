---
phase: 05-visualizations
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/types/analytics.ts
  - frontend/src/services/api.ts
  - frontend/src/hooks/useBatchAnalytics.ts
  - frontend/src/hooks/useBrushSelection.ts
  - frontend/src/components/batch/BatchAnalyticsPanel.tsx
  - frontend/src/components/batch/charts/ScoreHistogram.tsx
  - frontend/src/components/batch/charts/PropertyScatterPlot.tsx
  - frontend/src/components/batch/charts/AlertFrequencyChart.tsx
  - frontend/src/components/batch/charts/ValidationTreemap.tsx
  - frontend/src/components/batch/charts/ScaffoldTreemap.tsx
  - frontend/src/components/batch/charts/ChemicalSpaceScatter.tsx
  - frontend/src/pages/BatchValidation.tsx
autonomous: true
requirements:
  - VIZ-01
  - VIZ-02
  - VIZ-03
  - VIZ-04
  - VIZ-05
  - VIZ-06

must_haves:
  truths:
    - "Batch results page shows a tabbed analytics panel below the results table with 'Distributions' and 'Chemical Space' tabs"
    - "Score distribution histogram renders score tiers (excellent/good/moderate/poor) as colored bars from BatchStatistics"
    - "Property scatter plot renders any two selected properties as a scatter chart with color-by dropdown"
    - "Alert frequency bar chart renders alert type counts in descending order"
    - "Validation issue treemap renders hierarchical category-to-issue counts"
    - "Scaffold treemap renders top 50 scaffolds with 'Other' bucket and categorical colors"
    - "Chemical space scatter renders PCA coordinates with Canvas 2D for >800 points, with color-by property dropdown"
    - "Selecting molecules in one chart highlights them across all visible charts (linked brushing)"
    - "Each chart has a PNG/SVG download button"
    - "Skeleton placeholders show while analytics data loads"
    - "Summary badges on tabs show key metric counts"
  artifacts:
    - path: "frontend/src/types/analytics.ts"
      provides: "TypeScript interfaces mirroring backend analytics schemas"
      contains: "BatchAnalyticsResponse"
    - path: "frontend/src/services/api.ts"
      provides: "batchApi.getAnalytics and batchApi.triggerAnalytics methods"
      contains: "getAnalytics"
    - path: "frontend/src/hooks/useBatchAnalytics.ts"
      provides: "Analytics polling hook with trigger + poll-until-complete logic"
      contains: "useBatchAnalytics"
    - path: "frontend/src/hooks/useBrushSelection.ts"
      provides: "useReducer-based shared selection state for linked brushing"
      contains: "useBrushSelection"
    - path: "frontend/src/components/batch/BatchAnalyticsPanel.tsx"
      provides: "Tabbed container for 6 batch charts with skeleton loading"
      contains: "BatchAnalyticsPanel"
    - path: "frontend/src/components/batch/charts/ScoreHistogram.tsx"
      provides: "VIZ-01 score distribution histogram"
      contains: "ScoreHistogram"
    - path: "frontend/src/components/batch/charts/PropertyScatterPlot.tsx"
      provides: "VIZ-02 property scatter plot"
      contains: "PropertyScatterPlot"
    - path: "frontend/src/components/batch/charts/AlertFrequencyChart.tsx"
      provides: "VIZ-03 alert frequency bar chart"
      contains: "AlertFrequencyChart"
    - path: "frontend/src/components/batch/charts/ValidationTreemap.tsx"
      provides: "VIZ-04 validation issue treemap"
      contains: "ValidationTreemap"
    - path: "frontend/src/components/batch/charts/ScaffoldTreemap.tsx"
      provides: "VIZ-05 scaffold treemap"
      contains: "ScaffoldTreemap"
    - path: "frontend/src/components/batch/charts/ChemicalSpaceScatter.tsx"
      provides: "VIZ-06 chemical space scatter with Canvas 2D"
      contains: "ChemicalSpaceScatter"
  key_links:
    - from: "frontend/src/pages/BatchValidation.tsx"
      to: "frontend/src/components/batch/BatchAnalyticsPanel.tsx"
      via: "Import and render below BatchResultsTable in results state"
      pattern: "BatchAnalyticsPanel"
    - from: "frontend/src/components/batch/BatchAnalyticsPanel.tsx"
      to: "frontend/src/hooks/useBatchAnalytics.ts"
      via: "Hook call to fetch/poll analytics data"
      pattern: "useBatchAnalytics"
    - from: "frontend/src/components/batch/BatchAnalyticsPanel.tsx"
      to: "frontend/src/hooks/useBrushSelection.ts"
      via: "useReducer for linked brushing selection state"
      pattern: "useBrushSelection"
    - from: "frontend/src/hooks/useBatchAnalytics.ts"
      to: "frontend/src/services/api.ts"
      via: "batchApi.getAnalytics and batchApi.triggerAnalytics"
      pattern: "batchApi\\.getAnalytics"
---

<objective>
Build the complete Batch Visualization Suite: 6 interactive chart components in a tabbed analytics panel, integrated into the batch results page with linked brushing, skeleton loading, and PNG export per chart.

Purpose: Batch results become visually explorable — scientists can see score distributions, property relationships, alert patterns, scaffold diversity, and chemical space layout at a glance, with cross-chart selection for multi-dimensional exploration.

Output: 12 new/modified files — analytics types, API methods, two hooks (analytics polling + brush selection), tabbed container, 6 chart components, and BatchValidation page integration.
</objective>

<execution_context>
@/Users/kohulanrajan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kohulanrajan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-visualizations/05-CONTEXT.md
@.planning/phases/05-visualizations/05-RESEARCH.md
@frontend/src/types/batch.ts
@frontend/src/services/api.ts
@frontend/src/pages/BatchValidation.tsx
@frontend/src/components/batch/BatchResultsTable.tsx
@frontend/src/components/scoring-profiles/BioavailabilityCard.tsx
@frontend/src/components/scoring-profiles/ScoringProfilesTab.tsx
@frontend/src/pages/SingleValidation.tsx
@backend/app/schemas/analytics.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Analytics types, API methods, hooks, and tabbed container infrastructure</name>
  <files>
    frontend/src/types/analytics.ts
    frontend/src/services/api.ts
    frontend/src/hooks/useBatchAnalytics.ts
    frontend/src/hooks/useBrushSelection.ts
    frontend/src/components/batch/BatchAnalyticsPanel.tsx
    frontend/src/pages/BatchValidation.tsx
  </files>
  <action>
    **1. Create `frontend/src/types/analytics.ts`** — TypeScript interfaces mirroring the backend `analytics.py` schemas:
    - `AnalysisStatus` — status: 'pending' | 'computing' | 'complete' | 'failed' | 'skipped', computed_at, error
    - `ScaffoldGroup` — scaffold_smiles, generic_scaffold_smiles, molecule_indices: number[], count
    - `ScaffoldResult` — scaffolds: ScaffoldGroup[], unique_scaffold_count, shannon_entropy, frequency_distribution
    - `ChemSpaceCoordinates` — method: 'pca' | 'tsne', coordinates: number[][], molecule_indices: number[], variance_explained?: number[]
    - `PropertyStats` — property_name, mean, median, std, q1, q3, iqr, min, max, count
    - `OutlierInfo` — molecule_index, property_name, value, lower_fence, upper_fence
    - `PropertyCorrelation` — property_a, property_b, pearson_r
    - `QualityScore` — score, validity_pct, diversity_pct, druglikeness_pct
    - `StatisticsResult` — property_stats: PropertyStats[], correlations: PropertyCorrelation[], outliers: OutlierInfo[], quality_score: QualityScore
    - `SimilarityMatrixResult` — size, representation: 'dense' | 'sparse', data: any[]
    - `BatchAnalyticsResponse` — job_id, status: Record&lt;string, AnalysisStatus&gt;, scaffold?: ScaffoldResult, chemical_space?: ChemSpaceCoordinates, similarity_matrix?: SimilarityMatrixResult, statistics?: StatisticsResult
    - `AnalyticsTriggerResponse` — job_id, analysis_type, status

    **2. Add API methods to `frontend/src/services/api.ts`** — Extend the existing `batchApi` object with two new methods:
    - `getAnalytics(jobId: string): Promise<BatchAnalyticsResponse>` — GET `/batch/${jobId}/analytics`
    - `triggerAnalytics(jobId: string, analysisType: string, params?: Record<string, string>): Promise<AnalyticsTriggerResponse>` — POST `/batch/${jobId}/analytics/${analysisType}`
    Import the types from `../types/analytics`.

    **3. Create `frontend/src/hooks/useBatchAnalytics.ts`** — Custom hook for polling analytics:
    - Accepts `jobId: string` and `types: string[]` (e.g., ['scaffold', 'chemical_space', 'statistics'])
    - On mount: call `batchApi.triggerAnalytics(jobId, type)` for each requested type
    - Then poll `batchApi.getAnalytics(jobId)` every 2 seconds
    - Track status: 'idle' | 'computing' | 'complete' | 'error'
    - When all requested types have status 'complete' or 'failed', stop polling
    - Clean up interval on unmount
    - Return `{ data: BatchAnalyticsResponse | null, status, error, retrigger: (type: string) => void }`
    - The retrigger function allows re-computing a failed analytics type

    **4. Create `frontend/src/hooks/useBrushSelection.ts`** — useReducer for cross-chart linked brushing:
    - Selection state is a `Set<number>` of molecule indices (using index-based linking since all analytics use consistent integer indices — per research open question resolution)
    - Actions: SET (replace entire set), TOGGLE (add/remove single index), ADD_RANGE (for brush selection of a range), CLEAR
    - Export `useBrushSelection()` hook returning `[selectedIndices: Set<number>, dispatch]`
    - Export a `selectionReducer` for testing
    - Export action creator helpers: `setSelection(indices: Set<number>)`, `toggleIndex(index: number)`, `addRange(indices: number[])`, `clearSelection()`

    **5. Create `frontend/src/components/batch/BatchAnalyticsPanel.tsx`** — Tabbed container for 6 batch charts:
    - Two tabs: "Distributions" and "Chemical Space" (per research recommendation)
    - Tab bar pattern: match existing SingleValidation.tsx tabs — active = `bg-[var(--color-surface-elevated)]` white pill + primary text + `shadow-sm`, Framer Motion AnimatePresence mode="wait" for content transitions
    - Summary badges on tabs: "Distributions" shows "N outliers" from statistics outliers count; "Chemical Space" shows "N scaffolds" from scaffold unique count
    - Distributions tab contains: ScoreHistogram (VIZ-01), AlertFrequencyChart (VIZ-03), ValidationTreemap (VIZ-04) — arranged in a responsive grid (2 col on lg, 1 col on mobile)
    - Chemical Space tab contains: PropertyScatterPlot (VIZ-02), ScaffoldTreemap (VIZ-05), ChemicalSpaceScatter (VIZ-06) — same responsive grid
    - Each chart wrapped in a card with: header (icon + title), download button (Download icon from lucide-react), and the chart component
    - Skeleton loading: show ChartSkeleton (animate-pulse + chart-shaped placeholder at chart height) when analytics data is not yet loaded
    - Error state: if analytics status is 'failed', show amber warning card with retry button per chart slot
    - Props: `jobId: string`, `statistics: BatchStatistics | null`, `results: BatchResult[]`, `selectedIndices: Set<number>`, `onSelectionChange: (indices: Set<number>) => void`
    - Internally calls `useBatchAnalytics(jobId, ['scaffold', 'chemical_space', 'statistics'])` for the Chemical Space tab data
    - Distributions tab charts use `statistics` prop directly (no polling needed — already in BatchStatistics)
    - Wrap all chart components in `React.memo` to prevent cascade re-renders on selection changes
    - Each chart card wrapped in `<figure>` with `aria-label` and `<figcaption>` text summary for accessibility

    **6. Integrate into `frontend/src/pages/BatchValidation.tsx`**:
    - Import `BatchAnalyticsPanel`
    - Import `useBrushSelection` hook
    - Replace existing `selectedIndices` / `setSelectedIndices` state with `useBrushSelection()` hook
    - Add `BatchAnalyticsPanel` as a new card section BELOW the existing results table in the results state view (after the "Detailed Results" card, before the AnimatePresence closing tag)
    - Pass `jobId`, `statistics: resultsData.statistics`, `results: resultsData.results`, `selectedIndices`, and `onSelectionChange` that dispatches to brush selection reducer
    - Section header: BarChart3 icon + "Analytics &amp; Visualizations" title + "Interactive charts for batch analysis" subtitle
    - Do NOT modify BatchResultsTable props or rendering logic — only wire selection through the brush reducer
    - Ensure the `handleSelectionChange` callback bridges Set&lt;number&gt; indices from BatchResultsTable to the brush selection reducer (dispatch SET action)

    **Design notes:**
    - All chart colors derive from existing theme: score-excellent (#fbbf24), score-good (#d97706), score-fair (#ea580c), score-poor (#dc2626), primary (#c41e3a)
    - All Recharts charts use `<ResponsiveContainer width="100%" height={N}>` with `var(--color-border)` grid lines and `var(--color-text-secondary)` axis labels
    - Card pattern from ScoringProfilesTab: `rounded-2xl p-5 bg-gradient-to-br from-[var(--color-surface-elevated)] to-[var(--color-surface)] border border-[var(--color-border)]`
  </action>
  <verify>
    <automated>cd /Volumes/Data_Drive/Project/2026/chemstructval/frontend && npx tsc --noEmit 2>&1 | head -30</automated>
    <manual>Verify that frontend/src/types/analytics.ts exists with all interfaces, api.ts has getAnalytics/triggerAnalytics, both hooks exist, BatchAnalyticsPanel renders a tabbed layout, and BatchValidation.tsx imports and renders the panel below the results table.</manual>
  </verify>
  <done>
    - analytics.ts has all TypeScript interfaces matching backend schemas
    - api.ts has getAnalytics and triggerAnalytics methods on batchApi
    - useBatchAnalytics hook triggers analytics and polls until complete
    - useBrushSelection hook provides shared Set-based selection state with SET/TOGGLE/ADD_RANGE/CLEAR actions
    - BatchAnalyticsPanel renders two tabs with skeleton loading, error states, summary badges, and accessibility wrappers
    - BatchValidation.tsx renders BatchAnalyticsPanel below the results table, wired to brush selection
    - TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Six chart components (VIZ-01 through VIZ-06) with linked brushing and PNG export</name>
  <files>
    frontend/src/components/batch/charts/ScoreHistogram.tsx
    frontend/src/components/batch/charts/PropertyScatterPlot.tsx
    frontend/src/components/batch/charts/AlertFrequencyChart.tsx
    frontend/src/components/batch/charts/ValidationTreemap.tsx
    frontend/src/components/batch/charts/ScaffoldTreemap.tsx
    frontend/src/components/batch/charts/ChemicalSpaceScatter.tsx
  </files>
  <action>
    Create all 6 chart components as pure presentational React.memo components. Each receives data props + `selectedIndices: Set<number>` + `onSelectionChange: (indices: Set<number>) => void` + a `containerRef` for PNG export.

    **Shared patterns for all 6 charts:**
    - Wrap in `React.memo` to prevent cascade re-renders
    - Accept `selectedIndices` and `onSelectionChange` props for linked brushing
    - Accept `onDownload` prop (callback) — parent provides SVG serializer or canvas.toBlob download
    - For Recharts SVG charts: PNG download uses SVG serializer pattern from SingleValidation.tsx — `new XMLSerializer().serializeToString(svgEl)` to Blob, trigger download. Each chart wraps its content in a `div` with a ref for the SVG element query.
    - For Canvas charts: use `canvas.toBlob()` for PNG download
    - Return `null` gracefully if data is null/undefined (parent shows skeleton)
    - Highlighted points (in `selectedIndices`) use primary color (#c41e3a) with full opacity; non-selected use reduced opacity (0.4) when any selection is active
    - Tooltip uses existing theme colors: `bg-[var(--color-surface-elevated)]` with `border border-[var(--color-border)]`

    **VIZ-01: ScoreHistogram.tsx** — Score distribution histogram
    - Props: `data: { excellent: number, good: number, moderate: number, poor: number }`, selectedIndices, onSelectionChange
    - Use Recharts `<BarChart>` with `barCategoryGap={0}` and `barGap={0}` (histogram style)
    - 4 bars: Excellent (80-100) #fbbf24, Good (60-80) #d97706, Moderate (40-60) #ea580c, Poor (0-40) #dc2626
    - Custom tooltip showing count and percentage of total
    - Click on a bar dispatches selection of all molecule indices in that score range (pass results array to resolve indices by score range)
    - `<ResponsiveContainer width="100%" height={240}>`
    - CartesianGrid with strokeDasharray="3 3" and stroke="var(--color-border)"
    - XAxis/YAxis ticks: fontSize 10, fill "var(--color-text-secondary)"

    **VIZ-02: PropertyScatterPlot.tsx** — Property vs property scatter
    - Props: `results: BatchResult[]`, `xProperty: string`, `yProperty: string`, `colorByProperty: string`, selectedIndices, onSelectionChange, `onPropertyChange: (axis: 'x' | 'y' | 'color', property: string) => void`
    - Property options: MW, LogP (from QED/scoring), TPSA, QED, overall_score, SA_score, Fsp3 — extract values from BatchResult.scoring and BatchResult.validation
    - Dropdowns above chart for X-axis, Y-axis, and color-by property selection (3 small `<select>` elements styled with theme)
    - Use Recharts `<ScatterChart>` with `<Scatter>` and custom dot renderer that colors by the colorByProperty value using a continuous gradient (green to yellow to red)
    - Brush selection: use Recharts `<Brush>` component or click-to-select behavior — clicking a point toggles it in selectedIndices
    - Custom tooltip showing SMILES (truncated to 40 chars), property values, and score
    - `<ResponsiveContainer width="100%" height={320}>`
    - Selected points render with strokeWidth=2, stroke=#c41e3a, r=6; unselected with r=4, reduced opacity when selection is active

    **VIZ-03: AlertFrequencyChart.tsx** — Alert frequency bar chart
    - Props: `data: Record<string, number>` (alert_summary from BatchStatistics), selectedIndices, onSelectionChange
    - Transform to array sorted by count descending: `[{ name, count }]`
    - Use Recharts `<BarChart>` with `layout="vertical"` — horizontal bars for readability
    - Bar fill: `var(--color-primary)` (#c41e3a)
    - YAxis width=120 for alert type names, truncated with ellipsis if too long
    - Custom tooltip showing alert name and count
    - Click on a bar is informational only (no selection dispatch — alerts don't map 1:1 to molecule indices)
    - `<ResponsiveContainer width="100%" height={Math.max(200, Object.keys(data).length * 32)}>`
    - Show "No alerts detected" message if data is empty

    **VIZ-04: ValidationTreemap.tsx** — Validation issue treemap
    - Props: `data: Record<string, number>` (issue_summary from BatchStatistics), selectedIndices, onSelectionChange
    - Transform to hierarchical treemap data: group by category prefix (e.g., "stereo_", "composition_", "complexity_") → `[{ name: category, children: [{ name: issue, value: count }] }]`
    - If no clear prefix grouping, use flat treemap with each issue as a direct child
    - Use Recharts `<Treemap>` with custom `content` renderer
    - Custom content: render `<g>` with `<rect>` colored by category (categorical palette) + text label (show name if cell width > 60px and height > 30px, show count if height > 50px)
    - Categorical colors: use 8 distinct colors from the app palette (primary shades, amber, orange, emerald, blue, purple, pink, gray)
    - `<ResponsiveContainer width="100%" height={280}>`
    - Show "No validation issues" message if data is empty

    **VIZ-05: ScaffoldTreemap.tsx** — Scaffold frequency treemap
    - Props: `data: ScaffoldResult | null`, selectedIndices, onSelectionChange
    - Transform: sort scaffolds by count desc, take top 50, remainder as "Other" bucket (gray #6b7280)
    - Each scaffold cell gets a categorical color from a predefined palette (12-16 distinct colors cycling)
    - Custom content renderer: `<rect>` with fill color + scaffold SMILES label (truncated) + count label
    - Click on a scaffold cell dispatches selection of all molecule_indices in that scaffold group
    - `<ResponsiveContainer width="100%" height={320}>`
    - Tooltip shows scaffold SMILES (full), count, and percentage of total
    - Show "Computing scaffolds..." skeleton if data is null
    - Show "No scaffolds found" message if scaffolds array is empty

    **VIZ-06: ChemicalSpaceScatter.tsx** — Canvas 2D chemical space scatter
    - Props: `data: ChemSpaceCoordinates | null`, `results: BatchResult[]`, `colorByProperty: string`, `onColorByChange: (prop: string) => void`, selectedIndices, onSelectionChange
    - Canvas 2D rendering (NOT Recharts SVG) — required for >800 points per research
    - `useRef<HTMLCanvasElement>` + `useEffect` for drawing
    - Handle device pixel ratio for Retina displays: set canvas.width/height to logical * dpr, ctx.scale(dpr, dpr), CSS width/height to logical size
    - Map PCA/t-SNE coordinates to pixel space with 40px margins for axis labels
    - Draw each point as `ctx.arc(px, py, 4, 0, 2*PI)` with color from colorByProperty gradient
    - Selected points: fill with #c41e3a, radius 6; non-selected: radius 4, reduced opacity (0.4) when selection is active
    - Draw axes with labels: "PC1" / "PC2" or "t-SNE 1" / "t-SNE 2" depending on data.method
    - Hit detection: debounced 100ms mousemove handler doing linear scan over stored point coordinates. Find nearest point within 12px threshold. Show tooltip div (absolutely positioned) with SMILES, index, and property values.
    - Click: toggle the clicked point's molecule index in selectedIndices
    - Brush selection: mousedown+mousemove draws a selection rectangle (dashed blue outline), mouseup selects all points inside the rectangle
    - Store point pixel coordinates in `useRef` for hit detection
    - Dropdown above canvas for color-by property (same as VIZ-02)
    - "Compute t-SNE" button: visible only when data.method === 'pca', disabled for batches > 2000 molecules. Clicking triggers `batchApi.triggerAnalytics(jobId, 'chemical_space', { method: 'tsne' })` — parent handles this
    - Canvas dimensions: 100% width responsive via ResizeObserver, fixed 400px height
    - PNG download: `canvas.toBlob()` → download
    - Show "Computing chemical space..." skeleton if data is null
    - Clean up all event listeners and ResizeObserver on unmount

    **RDKit.js WASM memory safety for tooltips:**
    - Do NOT call `rdkit.get_mol()` in tooltips for batch charts — batch can have thousands of molecules. Instead, show SMILES text and key property values. Molecule structure rendering is reserved for VIZ-07 (comparison view) where only 1-2 molecules render at a time.
  </action>
  <verify>
    <automated>cd /Volumes/Data_Drive/Project/2026/chemstructval/frontend && npx tsc --noEmit 2>&1 | head -30</automated>
    <manual>Verify all 6 chart component files exist in frontend/src/components/batch/charts/, each exports a React.memo component, each accepts selectedIndices/onSelectionChange props, ChemicalSpaceScatter uses Canvas 2D (not Recharts).</manual>
  </verify>
  <done>
    - ScoreHistogram renders 4-bar colored histogram from score_distribution with click-to-select
    - PropertyScatterPlot renders configurable 2-property scatter with color-by dropdown and click-to-toggle selection
    - AlertFrequencyChart renders horizontal bar chart of alert frequencies sorted descending
    - ValidationTreemap renders hierarchical issue counts with categorical colors and custom content renderer
    - ScaffoldTreemap renders top 50 scaffolds + "Other" with categorical colors and click-to-select scaffold groups
    - ChemicalSpaceScatter renders PCA/t-SNE via Canvas 2D with hit detection, brush selection rectangle, color-by dropdown, and t-SNE compute button
    - All charts support linked brushing via selectedIndices prop
    - All charts support PNG/SVG download
    - TypeScript compiles without errors
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` — no TypeScript compilation errors
2. `cd frontend && npm run dev` — app starts, navigate to batch results page, verify analytics panel renders below results table
3. Visual checks: tabs switch between Distributions and Chemical Space, skeleton shows while loading, charts render with correct data, linked brushing works across charts, PNG download produces valid image files
4. Accessibility: each chart wrapped in `<figure>` with `aria-label` and `<figcaption>`
</verification>

<success_criteria>
- All 6 chart components render correctly from Phase 3/4 backend data
- Tabbed layout with summary badges matches existing app theme
- Linked brushing: selecting molecules in one chart highlights them in all others
- Canvas scatter handles up to 2000 points without browser jank
- PNG export works for all charts (SVG serializer for Recharts, canvas.toBlob for Canvas)
- No new npm packages added
- Existing batch results table and export functionality unaffected
</success_criteria>

<output>
After completion, create `.planning/phases/05-visualizations/05-01-SUMMARY.md`
</output>
